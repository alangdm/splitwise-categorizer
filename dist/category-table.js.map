{"version":3,"sources":["src/category-table.js"],"names":["html","css","LitElement","empty","resetCSS","sharedCSS","CLIPBOARD_MESSAGES","success","error","CategoryTable","styles","properties","categories","type","Array","attribute","totals","Object","clipboardMessage","String","constructor","_categoryTemplate","bind","_copy","table","shadowRoot","querySelector","text","innerText","trim","window","navigator","clipboard","writeText","e","_totalsTemplate","category","entries","map","currency","total","index","items","subtotals","date","description","cost","render","length","customElements","define"],"mappings":"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","sourceRoot":"/source_map/","sourcesContent":["import { html, css, LitElement, empty } from \"lit\";\n\nimport { resetCSS } from \"./reset.css.js\";\nimport { sharedCSS } from \"./shared.css.js\";\n\nconst CLIPBOARD_MESSAGES = {\n  success: \"Table copied to clipboard!\",\n  error: \"Couldn't copy to clipboard. Please do it manually.\",\n};\n\nclass CategoryTable extends LitElement {\n  static get styles() {\n    return [\n      resetCSS,\n      sharedCSS,\n      css`\n        :host {\n          display: grid;\n          grid-template-rows: auto 1fr;\n          gap: 1rem;\n        }\n        table {\n          width: 100%;\n          line-height: 2;\n          border-collapse: collapse;\n        }\n        td,\n        th {\n          padding: 0 0.5rem;\n        }\n        .table-header,\n        .table-footer {\n          background: var(--teal-9);\n          color: var(--gray-0);\n          font-weight: bold;\n        }\n        tbody\n          tr:not(.category-footer, .category-header, .table-header, .table-footer):hover {\n          background: var(--teal-2);\n        }\n        .category-header th {\n          text-align: left;\n        }\n        :where(.category-footer, .table-footer) th,\n        .currency {\n          text-align: right;\n        }\n        .category-footer + .category-header {\n          border-top: 2px solid var(--teal-9);\n        }\n      `,\n    ];\n  }\n\n  static get properties() {\n    return {\n      categories: { type: Array, attribute: false },\n      totals: { type: Object, attribute: false },\n      clipboardMessage: { type: String },\n    };\n  }\n\n  constructor() {\n    super();\n    this.categories = {};\n    this.clipboardMessage = \"\";\n    this._categoryTemplate = this._categoryTemplate.bind(this);\n  }\n\n  async _copy() {\n    const table = this.shadowRoot.querySelector(\"table\");\n    const text = table.innerText.trim();\n    try {\n      await window.navigator.clipboard.writeText(text);\n      this.clipboardMessage = CLIPBOARD_MESSAGES.success;\n    } catch (e) {\n      this.clipboardMessage = CLIPBOARD_MESSAGES.error;\n    }\n  }\n\n  _totalsTemplate({ category, totals }) {\n    const entries = Object.entries(totals);\n    return html`\n      ${entries.map(\n        ([currency, total], index) => html`\n          <tr class=\"${category ? \"category-footer\" : \"table-footer\"}\">\n            <td></td>\n            ${index === 0\n              ? html`<th scope=\"row\">\n                  ${category ? `${category} subtotal` : \"Total\"}\n                </th>`\n              : html`<td></td>`}\n            <td class=\"currency\">${currency}</td>\n            <td>${total}</td>\n          </tr>\n        `\n      )}\n    `;\n  }\n\n  _categoryTemplate([category, { items, subtotals }]) {\n    return html`\n      <tr class=\"category-header\">\n        <th scope=\"row\" colspan=\"4\">* ${category}</th>\n      </tr>\n      ${items.map(\n        ({ date, description, cost, currency }) => html`\n          <tr>\n            <td>${date}</td>\n            <td>${description}</td>\n            <td class=\"currency\">${currency}</td>\n            <td>${cost}</td>\n          </tr>\n        `\n      )}\n      ${this._totalsTemplate({ category, totals: subtotals })}\n    `;\n  }\n\n  render() {\n    const categories = Object.entries(this.categories);\n    if (categories.length === 0) {\n      return empty;\n    }\n    return html`\n      <div>\n        <button type=\"button\" @click=${this._copy}>Copy to clipboard</button>\n        <span>${this.clipboardMessage}</span>\n      </div>\n      <table>\n        <tbody>\n          <tr class=\"table-header\">\n            <th scope=\"col\">Date</th>\n            <th scope=\"col\">Description</th>\n            <th scope=\"col\">Currency</th>\n            <th scope=\"col\">Cost</th>\n          </tr>\n          ${categories.map(this._categoryTemplate)}\n          ${this._totalsTemplate({ totals: this.totals })}\n        </tbody>\n      </table>\n    `;\n  }\n}\n\nwindow.customElements.define(\"category-table\", CategoryTable);\n"]}