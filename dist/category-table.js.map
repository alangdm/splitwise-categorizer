{"version":3,"names":["html","css","LitElement","empty","resetCSS","sharedCSS","getPaymentMethodName","CLIPBOARD_MESSAGES","success","error","CategoryTable","styles","properties","categories","type","Array","attribute","totals","Object","paymentMethodTotals","clipboardMessage","String","constructor","_categoryTemplate","bind","_categoryTotalsTemplate","_copy","table","shadowRoot","querySelector","text","innerText","trim","window","navigator","clipboard","writeText","e","_totalsTemplate","header","cssClass","firstRowFix","entries","emptyCellContent","emptyCellClass","length","map","currency","total","index","category","items","date","description","cost","paymentMethod","subtotals","_paymentMethodTotalsTemplate","render","customElements","define"],"sourceRoot":"/source_map/","sources":["src/category-table.js"],"sourcesContent":["import { html, css, LitElement, empty } from \"lit\";\n\nimport { resetCSS } from \"./reset.css.js\";\nimport { sharedCSS } from \"./shared.css.js\";\n\nimport { getPaymentMethodName } from \"./utils.js\";\n\nconst CLIPBOARD_MESSAGES = {\n  success: \"Table copied to clipboard!\",\n  error: \"Couldn't copy to clipboard. Please do it manually.\",\n};\n\nclass CategoryTable extends LitElement {\n  static get styles() {\n    return [\n      resetCSS,\n      sharedCSS,\n      css`\n        :host {\n          display: grid;\n          grid-template-rows: auto 1fr;\n          gap: 1rem;\n        }\n        table {\n          width: 100%;\n          line-height: 2;\n          border-collapse: collapse;\n        }\n        td,\n        th {\n          padding: 0 0.5rem;\n        }\n        .table-header,\n        .table-footer {\n          background: var(--teal-9);\n          color: var(--gray-0);\n          font-weight: bold;\n        }\n        .payment-method-footer {\n          background: var(--teal-7);\n          color: var(--gray-0);\n          font-weight: bold;\n        }\n        tbody\n          tr:not(.category-footer, .category-header, .table-header, .table-footer, .payment-method-footer):hover {\n          background: var(--teal-2);\n        }\n        .category-header th {\n          text-align: left;\n        }\n        :where(.category-footer, .table-footer, .payment-method-footer) th,\n        .currency {\n          text-align: right;\n        }\n        .category-footer + .category-header {\n          border-top: 2px solid var(--teal-9);\n        }\n        .first-row-fix {\n          color: var(--teal-9);\n        }\n      `,\n    ];\n  }\n\n  static get properties() {\n    return {\n      categories: { type: Array, attribute: false },\n      totals: { type: Object, attribute: false },\n      paymentMethodTotals: { type: Object, attribute: false },\n      clipboardMessage: { type: String },\n    };\n  }\n\n  constructor() {\n    super();\n    this.categories = {};\n    this.clipboardMessage = \"\";\n    this._categoryTemplate = this._categoryTemplate.bind(this);\n    this._categoryTotalsTemplate = this._categoryTotalsTemplate.bind(this);\n  }\n\n  async _copy() {\n    const table = this.shadowRoot.querySelector(\"table\");\n    const text = table.innerText.trim();\n    try {\n      await window.navigator.clipboard.writeText(text);\n      this.clipboardMessage = CLIPBOARD_MESSAGES.success;\n    } catch (e) {\n      this.clipboardMessage = CLIPBOARD_MESSAGES.error;\n    }\n  }\n\n  _totalsTemplate({ header, totals, cssClass = \"table-footer\", firstRowFix }) {\n    const entries = Object.entries(totals);\n\n    // fix to avoid empty space trimming copy issues\n    const emptyCellContent = firstRowFix ? \".\" : empty;\n    const emptyCellClass = firstRowFix ? \"first-row-fix\" : \"\";\n\n    if (entries.length === 0) {\n      return html`\n        <tr class=${cssClass}>\n          <td class=${emptyCellClass}>${emptyCellContent}</td>\n          <td class=${emptyCellClass}>${emptyCellContent}</td>\n          <th scope=\"row\">${header ? `${header} subtotal` : \"Total\"}</th>\n          <td></td>\n          <td>0</td>\n        </tr>\n      `;\n    }\n\n    return html`\n      ${entries.map(\n        ([currency, total], index) => html`\n          <tr class=${cssClass}>\n            <td class=${emptyCellClass}>${emptyCellContent}</td>\n            <td class=${emptyCellClass}>${emptyCellContent}</td>\n            ${index === 0\n              ? html`<th scope=\"row\">\n                  ${header ? `${header} subtotal` : \"Total\"}\n                </th>`\n              : html`<td></td>`}\n            <td class=\"currency\">${currency}</td>\n            <td>${total}</td>\n          </tr>\n        `\n      )}\n    `;\n  }\n\n  _categoryTemplate([category, { items }]) {\n    if (items.length === 0) {\n      return empty;\n    }\n    return html`\n      <tr class=\"category-header\">\n        <th scope=\"row\" colspan=\"5\">* ${category}</th>\n      </tr>\n      ${items.map(\n        ({ date, description, cost, currency, paymentMethod = \"\" }) => html`\n          <tr>\n            <td>${date}</td>\n            <td>${description}</td>\n            <td>${getPaymentMethodName(paymentMethod)}</td>\n            <td class=\"currency\">${currency}</td>\n            <td>${cost}</td>\n          </tr>\n        `\n      )}\n    `;\n  }\n\n  _categoryTotalsTemplate([category, { subtotals }]) {\n    return html`\n      ${this._totalsTemplate({\n        header: category,\n        totals: subtotals,\n        cssClass: \"category-footer\",\n      })}\n    `;\n  }\n\n  _paymentMethodTotalsTemplate() {\n    const entries = Object.entries(this.paymentMethodTotals);\n    return html`\n      ${entries.map(([paymentMethod, totals]) =>\n        this._totalsTemplate({\n          header: getPaymentMethodName(paymentMethod),\n          totals,\n          cssClass: \"payment-method-footer\",\n        })\n      )}\n    `;\n  }\n\n  render() {\n    const categories = Object.entries(this.categories);\n    if (categories.length === 0) {\n      return empty;\n    }\n    return html`\n      <div>\n        <button type=\"button\" @click=${this._copy}>Copy to clipboard</button>\n        <span>${this.clipboardMessage}</span>\n      </div>\n      <table>\n        <tbody>\n          ${this._totalsTemplate({ totals: this.totals, firstRowFix: true })}\n          ${categories.map(this._categoryTotalsTemplate)}\n          ${this._paymentMethodTotalsTemplate()}\n          <tr class=\"table-header\">\n            <th scope=\"col\">Date</th>\n            <th scope=\"col\">Description</th>\n            <th scope=\"col\">Payment Method</th>\n            <th scope=\"col\">Currency</th>\n            <th scope=\"col\">Cost</th>\n          </tr>\n          ${categories.map(this._categoryTemplate)}\n        </tbody>\n      </table>\n    `;\n  }\n}\n\nwindow.customElements.define(\"category-table\", CategoryTable);\n"],"mappings":"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"}