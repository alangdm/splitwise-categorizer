{"version":3,"sources":["src/csv-input.js"],"names":["html","css","LitElement","resetCSS","sharedCSS","PLACEHOLDERS","normal","highlight","CSV_REGEX","CSVInput","styles","properties","csv","type","String","highlighted","Boolean","reflect","render","_textChange","constructor","_highlight","bind","_unhighlight","_drop","connectedCallback","document","addEventListener","capture","disconnectedCallback","removeEventListener","e","target","value","preventDefault","stopPropagation","_handleFiles","dataTransfer","files","fileArr","f","test","name","_readFile","file","Promise","resolve","reject","reader","FileReader","readAsText","result","window","customElements","define"],"mappings":"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","sourceRoot":"/source_map/","sourcesContent":["import { html, css, LitElement } from \"lit\";\r\n\r\nimport { resetCSS } from \"./reset.css.js\";\r\nimport { sharedCSS } from \"./shared.css.js\";\r\n\r\nconst PLACEHOLDERS = {\r\n  normal: \"Paste the full Splitwise CSV here\",\r\n  highlight: \"Drop the Splitwise CSV file here\",\r\n};\r\n\r\nconst CSV_REGEX = /.*\\.csv$/i;\r\n\r\nclass CSVInput extends LitElement {\r\n  static get styles() {\r\n    return [\r\n      resetCSS,\r\n      sharedCSS,\r\n      css`\r\n        :host {\r\n          display: flex;\r\n          flex-flow: column wrap;\r\n          align-items: start;\r\n          gap: 0.5rem;\r\n        }\r\n        label {\r\n          font-weight: bold;\r\n        }\r\n        textarea {\r\n          resize: block;\r\n        }\r\n        :host([highlighted]) textarea,\r\n        textarea:focus-visible {\r\n          outline: solid var(--primary-color);\r\n        }\r\n      `,\r\n    ];\r\n  }\r\n\r\n  static get properties() {\r\n    return {\r\n      csv: { type: String },\r\n      highlighted: { type: Boolean, reflect: true },\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return html`\r\n      <label for=\"csv\">Splitwise CSV</label>\r\n      <textarea\r\n        id=\"csv\"\r\n        rows=\"5\"\r\n        cols=\"80\"\r\n        placeholder=${this.highlighted\r\n          ? PLACEHOLDERS.highlight\r\n          : PLACEHOLDERS.normal}\r\n        .value=${this.csv}\r\n        @change=${this._textChange}\r\n      ></textarea>\r\n    `;\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.csv = \"\";\r\n    this._highlight = this._highlight.bind(this);\r\n    this._unhighlight = this._unhighlight.bind(this);\r\n    this._drop = this._drop.bind(this);\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    document.addEventListener(\"dragenter\", this._highlight, { capture: false });\r\n    document.addEventListener(\"dragover\", this._highlight, { capture: false });\r\n    document.addEventListener(\"dragleave\", this._unhighlight, {\r\n      capture: false,\r\n    });\r\n    document.addEventListener(\"drop\", this._unhighlight, { capture: false });\r\n    document.addEventListener(\"drop\", this._drop);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    document.removeEventListener(\"dragenter\", this._highlight);\r\n    document.removeEventListener(\"dragover\", this._highlight);\r\n    document.removeEventListener(\"dragleave\", this._unhighlight);\r\n    document.removeEventListener(\"drop\", this._unhighlight);\r\n    document.removeEventListener(\"drop\", this._drop);\r\n  }\r\n\r\n  _textChange(e) {\r\n    this.csv = e.target.value;\r\n  }\r\n\r\n  _highlight(e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    this.highlighted = true;\r\n  }\r\n\r\n  _unhighlight(e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    this.highlighted = false;\r\n  }\r\n\r\n  _drop(e) {\r\n    this._handleFiles(e.dataTransfer.files);\r\n  }\r\n\r\n  async _handleFiles(files) {\r\n    const fileArr = [...files];\r\n    for (const f of fileArr) {\r\n      if (CSV_REGEX.test(f.name)) {\r\n        this.csv = await this._readFile(f);\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  _readFile(file) {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.readAsText(file, \"UTF-8\");\r\n      reader.addEventListener(\"loadend\", () => resolve(reader.result));\r\n      reader.addEventListener(\"error\", reject);\r\n    });\r\n  }\r\n}\r\n\r\nwindow.customElements.define(\"csv-input\", CSVInput);\r\n"]}